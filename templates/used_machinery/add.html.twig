{% extends 'base.html.twig' %}

{% block title %}Agregar Maquinaria{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link href="{{ asset('styles/add_machinery.css') }}" rel="stylesheet" />
{% endblock %}

{% block body %}
<div class="form-container">
    <h1>Agregar Maquinaria</h1>

    {{ form_start(form) }}
    <div class="form-group-container">
        <div class="form-group machinery-type-selector">
            <h3>Tipo de Maquinaria</h3>
            {{ form_widget(form.isNew) }}
            {{ form_errors(form.isNew, {'attr': {'class': 'form-error'}}) }}
        </div>

        <div class="form-group">
            {{ form_label(form.category) }}
            {{ form_widget(form.category) }}
            {{ form_errors(form.category, {'attr': {'class': 'form-error'}}) }}
        </div>

        <div class="form-group">
            {{ form_label(form.model) }}
            {{ form_widget(form.model) }}
            {{ form_errors(form.model, {'attr': {'class': 'form-error'}}) }}
        </div>

        <div class="form-group brand-group">
            {{ form_label(form.brand) }}
            {{ form_widget(form.brand) }}
            {{ form_errors(form.brand, {'attr': {'class': 'form-error'}}) }}
            <div class="brand-suggestions" style="display: none;"></div>
        </div>

        <div class="form-group">
            {{ form_label(form.fuelTankCapacity) }}
            {{ form_widget(form.fuelTankCapacity) }}
            {{ form_errors(form.fuelTankCapacity, {'attr': {'class': 'form-error'}}) }}
        </div>

        <div class="form-group">
            {{ form_label(form.technology) }}
            {{ form_widget(form.technology) }}
            {{ form_errors(form.technology, {'attr': {'class': 'form-error'}}) }}
        </div>

        <div class="form-group">
            {{ form_label(form.transmissionSystem) }}
            {{ form_widget(form.transmissionSystem) }}
            {{ form_errors(form.transmissionSystem, {'attr': {'class': 'form-error'}}) }}
        </div>

        {# Reemplazar el campo location por provincia y locality #}
        <div class="form-group location-group">
            {{ form_label(form.provincia) }}
            {{ form_widget(form.provincia) }}
            {{ form_errors(form.provincia, {'attr': {'class': 'form-error'}}) }}
            <div class="provincia-suggestions" style="display: none;"></div>
        </div>

        <div class="form-group location-group">
            {{ form_label(form.locality) }}
            {{ form_widget(form.locality) }}
            {{ form_errors(form.locality, {'attr': {'class': 'form-error'}}) }}
            <div class="locality-suggestions" style="display: none;"></div>
        </div>

        <div class="form-group price-field">
            {{ form_label(form.price) }}
            {{ form_widget(form.price) }}
            {{ form_errors(form.price, {'attr': {'class': 'form-error'}}) }}
        </div>

        <div class="form-group taxpayer-type-field">
            {{ form_label(form.taxpayerType) }}
            {{ form_widget(form.taxpayerType) }}
            {{ form_errors(form.taxpayerType, {'attr': {'class': 'form-error'}}) }}
            <div id="pricePreview" class="price-preview" style="display: none;">
                <p>Precio Base: <span id="basePrice">$0.00</span></p>
                <p>IVA: <span id="ivaAmount">$0.00</span></p>
                <p>Precio Final: <span id="finalPrice">$0.00</span></p>
            </div>
        </div>

        <div class="form-group load-capacity-field">
            {{ form_label(form.loadCapacity) }}
            {{ form_widget(form.loadCapacity) }}
            {{ form_errors(form.loadCapacity, {'attr': {'class': 'form-error'}}) }}
        </div>

        <div class="form-group imagen-input">
            {{ form_label(form.imageFilenames) }}
            {{ form_widget(form.imageFilenames) }}
            {{ form_errors(form.imageFilenames, {'attr': {'class': 'form-error'}}) }}
            <small class="form-text text-muted">Puedes seleccionar hasta 5 im√°genes</small>
        </div>

        <div class="used-fields-container">
            <h3 class="full-width">Detalles de Maquinaria Usada</h3>
            
            <div class="form-group">
                {{ form_label(form.manufacturingDate) }}
                {{ form_widget(form.manufacturingDate) }}
                {{ form_errors(form.manufacturingDate, {'attr': {'class': 'form-error'}}) }}
            </div>

            <div class="form-group">
                {{ form_label(form.hoursOfUse) }}
                {{ form_widget(form.hoursOfUse) }}
                {{ form_errors(form.hoursOfUse, {'attr': {'class': 'form-error'}}) }}
            </div>

            <div class="form-group">
                {{ form_label(form.lastService) }}
                {{ form_widget(form.lastService) }}
                {{ form_errors(form.lastService, {'attr': {'class': 'form-error'}}) }}
            </div>
        </div>

        <div class="form-group full-width">
            <div class="buttons-container">
                <button type="submit" class="btn btn-primary">Agregar</button>
                <a href="{{ path('app_view_used_machinery') }}" class="btn btn-secondary">Volver</a>
            </div>
        </div>
    </div>
    {{ form_end(form) }}
</div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('js/brands.js') }}"></script>
    <script src="{{ asset('js/locations.js') }}"></script>
    <script src="{{ asset('js/add_machinery.js') }}"></script>
{% endblock %}